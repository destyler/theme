---
import TableOfContentsList from '../components/TableOfContents/TableOfContentsList.astro'

const { toc } = Astro.locals.starlightRoute

let TOCExtra: any = null
try {
  TOCExtra = (await import('virtual:user-component:TOCExtra')).default
}
catch {
  TOCExtra = null
}
---

{
  toc && (
    <starlight-toc data-min-h={toc.minHeadingLevel} data-max-h={toc.maxHeadingLevel}>
      <nav aria-labelledby="starlight__on-this-page">
        <p id="starlight__on-this-page">Table of Contents</p>
        <TableOfContentsList toc={toc.items} />
      </nav>
      <slot />
      {TOCExtra && <TOCExtra />}
    </starlight-toc>
  )
}

<script src="../components/TableOfContents/starlight-toc"></script>

<style>
  starlight-toc {
    overflow: auto;
    height: 100%;
    padding-top: 0.75rem;
    padding-bottom: 2.5rem;
    scrollbar-width: none;
  }
  nav {
    position: relative;
  }
  /* Keep the TOC title visible at the top while the list scrolls in desktop */
  #starlight__on-this-page {
    position: sticky;
    /* Match the container's top padding to avoid shift on first scroll */
    top: 0.75rem;
    z-index: 10;
    display: block;
  }
  p {
    font-weight: 500;
  }
</style>
